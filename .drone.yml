kind: pipeline
type: docker
name: build

trigger:
  event:
    - tag

steps:
  - name: push-docker-image
    image: plugins/docker
    # image: node:14.15.0-alpine

    settings:
      repo: ${DRONE_REPO}
      registry: ghcr.io/${DRONE_REPO_OWNER}
      dockerfile: ./docker/Dockerfile
      # username:
      #   from_secret: github_username
      # password:
      #   from_secret: github_password

    environment:
      CR_PAT:
        from_secret: CR_PAT

    commands:
      - echo $CR_PAT
    #   - docker ps
    # - docker build -t docker.pkg.github.com/${DRONE_REPO}/${DRONE_REPO_NAME}-image:${DRONE_TAG} ./docker
